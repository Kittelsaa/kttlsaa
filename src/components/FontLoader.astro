---
// FontLoader.astro - Component to ensure fonts are loaded on all pages
---

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Averia+Serif+Libre:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">

<style is:global>
  /* Super high specificity selectors to force the fonts */
  /* Headings get Averia */
  html body h1, 
  html body h2, 
  html body h3, 
  html body h4, 
  html body h5, 
  html body h6,
  html body .title, 
  html body .heading, 
  html body [class*="title"], 
  html body [class*="heading"],
  html body header h1, 
  html body header h2, 
  html body header h3,
  html body main h1, 
  html body main h2, 
  html body main h3,
  html body article h1, 
  html body article h2, 
  html body article h3,
  html body section h1, 
  html body section h2, 
  html body section h3,
  html body div h1, 
  html body div h2, 
  html body div h3 {
    font-family: 'Averia Serif Libre', serif !important;
  }
  
  /* All other text gets Inter */
  html body p,
  html body a,
  html body span,
  html body div,
  html body li,
  html body input,
  html body textarea,
  html body button,
  html body label,
  html body blockquote,
  html body table,
  html body pre,
  html body code {
    font-family: 'Inter', sans-serif !important;
  }
  
  /* Add !important to all heading elements */
  h1, h2, h3, h4, h5, h6 {
    font-family: 'Averia Serif Libre', serif !important;
  }
</style>

<script>
  // Function to apply fonts
  function applyFonts() {
    // Target all heading elements with maximum specificity
    const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6, .title, .heading, [class*="title"], [class*="heading"]');
    headings.forEach(heading => {
      heading.style.setProperty('font-family', "'Averia Serif Libre', serif", 'important');
    });
    
    // Target all body text elements
    const bodyText = document.querySelectorAll('p, a, span, div, li, input, textarea, button, label, blockquote, table, pre, code');
    bodyText.forEach(text => {
      text.style.setProperty('font-family', "'Inter', sans-serif", 'important');
    });
    
    console.log('Fonts applied to elements');
  }

  // Apply immediately
  applyFonts();
  
  // Apply after fonts are loaded
  document.fonts.ready.then(() => {
    applyFonts();
  });
  
  // Apply after DOM is fully loaded
  document.addEventListener('DOMContentLoaded', () => {
    applyFonts();
  });
  
  // Apply after everything is loaded
  window.addEventListener('load', () => {
    applyFonts();
    
    // Apply one more time after a slight delay to catch any late-rendered elements
    setTimeout(applyFonts, 500);
  });
  
  // Apply periodically to catch any dynamically added elements
  setInterval(applyFonts, 2000);
</script>


